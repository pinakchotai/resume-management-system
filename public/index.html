<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Submit Resume - Resume Management System</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <div class="card">
        <div class="form-container">
            <h1>Submit your resume</h1>
            <form id="resumeForm" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="fullName">Name</label>
                    <input type="text" class="form-control" id="fullName" name="fullName" required>
                </div>

                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" class="form-control" id="email" name="email" required>
                </div>

                <div class="form-group">
                    <label for="phone">Phone Number</label>
                    <input type="tel" class="form-control" id="phone" name="phone" required>
                </div>

                <div class="form-group">
                    <label for="experience">Years of experience</label>
                    <input type="number" class="form-control" id="experience" name="experience" required>
                </div>

                <div class="form-group">
                    <label for="skills">Skills</label>
                    <input type="text" class="form-control" id="skills" name="skills">
                </div>

                <div class="form-group">
                    <label for="currentRole">Current Role</label>
                    <input type="text" class="form-control" id="currentRole" name="currentRole">
                </div>

                <div class="form-group">
                    <label for="resume">Resume</label>
                    <div class="file-upload-area">
                        <input type="file" id="resume" name="resume" accept=".pdf,.doc,.docx" required style="display: none;">
                        <button type="button" class="file-upload-button" onclick="document.getElementById('resume').click()">
                            Choose a file
                        </button>
                        <div id="fileName" class="file-name"></div>
                    </div>
                </div>

                <button type="submit" class="submit-button" id="submitButton">Submit Application</button>
            </form>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('resumeForm');
            const fileInput = document.getElementById('resume');
            const fileNameDisplay = document.getElementById('fileName');
            const submitButton = document.getElementById('submitButton');
            const uploadButton = document.querySelector('.file-upload-button');

            // File input change handler
            fileInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    fileNameDisplay.textContent = file.name;
                    uploadButton.classList.add('has-file');
                    // Validate file type
                    const allowedTypes = ['.pdf', '.doc', '.docx'];
                    const fileExt = file.name.substring(file.name.lastIndexOf('.')).toLowerCase();
                    if (!allowedTypes.includes(fileExt)) {
                        alert('Please upload a PDF, DOC, or DOCX file');
                        fileInput.value = '';
                        fileNameDisplay.textContent = '';
                        uploadButton.classList.remove('has-file');
                    }
                } else {
                    fileNameDisplay.textContent = '';
                    uploadButton.classList.remove('has-file');
                }
            });

            // Form submission handler
            form.addEventListener('submit', async function(e) {
                e.preventDefault();
                submitButton.disabled = true;
                submitButton.textContent = 'Submitting...';
                
                try {
                    const formData = new FormData(form);
                    
                    const response = await fetch('/api/submissions', {
                        method: 'POST',
                        body: formData
                    });

                    const result = await response.json();

                    if (!response.ok) {
                        throw new Error(result.error || 'Failed to submit application');
                    }

                    alert('Application submitted successfully!');
                    form.reset();
                    fileNameDisplay.textContent = '';
                    uploadButton.classList.remove('has-file');
                } catch (error) {
                    console.error('Submission error:', error);
                    alert(error.message || 'Error submitting form');
                } finally {
                    submitButton.disabled = false;
                    submitButton.textContent = 'Submit Application';
                }
            });
        });
    </script>
</body>
</html> 